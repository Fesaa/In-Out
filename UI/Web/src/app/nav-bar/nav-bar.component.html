<div class="nav-wrapper">
  <nav class="nav-header">
    <div class="nav-left">
      <button class="hamburger" (click)="toggleMobileMenu()">
        &#9776;
      </button>

      <div class="nav-links desktop-only">
        @for (item of mainItems(); track item.id) {
          <ng-container [ngTemplateOutlet]="navItem" [ngTemplateOutletContext]="{$implicit: item}"></ng-container>
        }
      </div>
    </div>

    <div class="nav-right">

      <div class="dropdown">
        @if (authService.userInfo(); as userInfo) {
          <button class="account-toggle btn btn-secondary" (click)="toggleAccountDropdown()">
            {{ userInfo.name | titlecase }}
          </button>

          @if (navService.isAccountDropdownOpen()) {
            <ul class="account-dropdown" @dropdownAnimation>
              @for (item of accountItems(); track item.id) {
                <li>
                  <ng-container [ngTemplateOutlet]="navItem" [ngTemplateOutletContext]="{$implicit: item}"></ng-container>
                </li>
              }
            </ul>
          }
        }
      </div>
    </div>
  </nav>

  @if (navService.isMobileMenuOpen()) {
    <div class="mobile-drawer" @drawerAnimation>
      <div class="drawer-header">
        <button (click)="toggleMobileMenu()">âœ•</button>
      </div>
      <div class="drawer-links">
        @for (item of mainItems(); track item.id) {
          <ng-container [ngTemplateOutlet]="navItem" [ngTemplateOutletContext]="{$implicit: item}"></ng-container>
        }
      </div>
    </div>
  }

</div>

<ng-template #navItem let-item>
  @if (item.routerLink) {
    <a
      class="nav-link"
      [routerLink]="item.routerLink"
      (click)="navService.isAccountDropdownOpen.set(false)"
    >
      @if (item.icon) {
        <i class="fa {{ item.icon }}"></i>
      }
      {{ item.translationKey | transloco }}
    </a>
  } @else if (item.action) {
    <a
      (click)="item.action(); navService.isAccountDropdownOpen.set(false)"
    >
      @if (item.icon) {
        <i class="fa {{ item.icon }}"></i>
      }
      {{ item.translationKey | transloco }}
    </a>
  }
</ng-template>
